(window.webpackJsonp=window.webpackJsonp||[]).push([[111],{367:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var three_module=__webpack_require__(718),THREE=(__webpack_require__(22),__webpack_require__(742),__webpack_require__(14),__webpack_require__(743),__webpack_require__(744),__webpack_require__(745),__webpack_require__(746),__webpack_require__(747),__webpack_require__(748),__webpack_require__(749),__webpack_require__(750),__webpack_require__(751),__webpack_require__(752),__webpack_require__(753),__webpack_require__(754),__webpack_require__(755),__webpack_require__(756),__webpack_require__(757),__webpack_require__(758),__webpack_require__(759),__webpack_require__(760),__webpack_require__(761),__webpack_require__(762),__webpack_require__(763),__webpack_require__(764),__webpack_require__(765),__webpack_require__(766),__webpack_require__(718));THREE.CardboardEffect=function(renderer){var _camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),_scene=new THREE.Scene,_stereo=new THREE.StereoCamera;_stereo.aspect=.5;var _params={minFilter:THREE.LinearFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat},_renderTarget=new THREE.WebGLRenderTarget(512,512,_params);_renderTarget.scissorTest=!0;var distortion=new THREE.Vector2(.441,.156),geometry=new THREE.PlaneBufferGeometry(1,1,10,20).removeAttribute("normal").toNonIndexed(),positions=geometry.attributes.position.array,uvs=geometry.attributes.uv.array,positions2=new Float32Array(2*positions.length);positions2.set(positions),positions2.set(positions,positions.length);var uvs2=new Float32Array(2*uvs.length);uvs2.set(uvs),uvs2.set(uvs,uvs.length);for(var vector=new THREE.Vector2,length=positions.length/3,i=0,l=positions2.length/3;i<l;i++){vector.x=positions2[3*i+0],vector.y=positions2[3*i+1];var dot=vector.dot(vector),scalar=1.5+(distortion.x+distortion.y*dot)*dot,offset=i<length?0:1;positions2[3*i+0]=vector.x/scalar*1.5-.5+offset,positions2[3*i+1]=vector.y/scalar*3,uvs2[2*i]=.5*(uvs2[2*i]+offset)}geometry.attributes.position.array=positions2,geometry.attributes.uv.array=uvs2;var material=new THREE.MeshBasicMaterial({map:_renderTarget}),mesh=new THREE.Mesh(geometry,material);_scene.add(mesh),this.setSize=function(width,height){renderer.setSize(width,height);var pixelRatio=renderer.getPixelRatio();_renderTarget.setSize(width*pixelRatio,height*pixelRatio)},this.render=function(scene,camera){scene.updateMatrixWorld(),null===camera.parent&&camera.updateMatrixWorld(),_stereo.update(camera);var width=_renderTarget.width/2,height=_renderTarget.height;_renderTarget.scissor.set(0,0,width,height),_renderTarget.viewport.set(0,0,width,height),renderer.render(scene,_stereo.cameraL,_renderTarget),_renderTarget.scissor.set(width,0,width,height),_renderTarget.viewport.set(width,0,width,height),renderer.render(scene,_stereo.cameraR,_renderTarget),renderer.render(_scene,_camera)}};var DeviceOrientationControls=function(object){var scope=this;this.object=object,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alphaOffset=0;var zee,euler,q0,q1,onDeviceOrientationChangeEvent=function(event){scope.deviceOrientation=event},onScreenOrientationChangeEvent=function(){scope.screenOrientation=window.orientation||0},setObjectQuaternion=(zee=new three_module.Vector3(0,0,1),euler=new three_module.Euler,q0=new three_module.Quaternion,q1=new three_module.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5)),function(quaternion,alpha,beta,gamma,orient){euler.set(beta,alpha,-gamma,"YXZ"),quaternion.setFromEuler(euler),quaternion.multiply(q1),quaternion.multiply(q0.setFromAxisAngle(zee,-orient))});this.connect=function(){onScreenOrientationChangeEvent(),window.addEventListener("orientationchange",onScreenOrientationChangeEvent,!1),window.addEventListener("deviceorientation",onDeviceOrientationChangeEvent,!1),scope.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",onScreenOrientationChangeEvent,!1),window.removeEventListener("deviceorientation",onDeviceOrientationChangeEvent,!1),scope.enabled=!1},this.update=function(){if(!1!==scope.enabled){var device=scope.deviceOrientation;if(device){var alpha=device.alpha?three_module.Math.degToRad(device.alpha)+scope.alphaOffset:0,beta=device.beta?three_module.Math.degToRad(device.beta):0,gamma=device.gamma?three_module.Math.degToRad(device.gamma):0,orient=scope.screenOrientation?three_module.Math.degToRad(scope.screenOrientation):0;setObjectQuaternion(scope.object.quaternion,alpha,beta,gamma,orient)}}},this.dispose=function(){scope.disconnect()},this.connect()},SceneUtils=__webpack_require__(721);__webpack_exports__.default=function(){alert("\n  r76でCardboardEffect削除\n  https://github.com/mrdoob/three.js/commit/7af1717056499a4ad5cbb3c6cc9cd6b717d0970a\n  ");var VIEWPORT_W=window.innerWidth,VIEWPORT_H=window.innerHeight,scene=new three_module.Scene,camera=new three_module.PerspectiveCamera(45,window.innerWidth/window.innerHeight,.1,1e3);camera.position.x=8,camera.lookAt(new three_module.Vector3(0,0,0));var renderer=new three_module.WebGLRenderer;renderer.setClearColor(new three_module.Color(0)),renderer.setSize(VIEWPORT_W,VIEWPORT_H),renderer.shadowMap.enabled=!0;var selectedDebri,geom,textureLoader,planetTexture,specularTexture,normalTexture,planetMaterial,controls=new DeviceOrientationControls(camera),effect=new three_module.CardboardEffect(renderer),raycaster=new three_module.Raycaster,createStarPoints=function(num,size,center,radius,red){for(var geom=new three_module.Geometry,texture=(new three_module.TextureLoader).load(red?"./assets/lensflare0.png":"./assets/lensflare0_white.png"),material=new three_module.PointsMaterial({size:size,map:texture}),i=0;i<num;i++){var theta=2*Math.random()*Math.PI,phi=2*Math.random()*Math.PI,r=radius*(1.5+Math.random()/10),particle=new three_module.Vector3(r*Math.sin(theta)*Math.cos(phi),r*Math.sin(theta)*Math.sin(phi),r*Math.cos(theta));geom.vertices.push(particle)}return new three_module.Points(geom,material)},putDebriRandom=function(mesh,limitRadius,center){var theta=2*Math.random()*Math.PI,phi=2*Math.random()*Math.PI,r=2*limitRadius+Math.random()/100;mesh.position.set(center.x+r*Math.sin(theta)*Math.cos(phi),center.y+r*Math.sin(theta)*Math.sin(phi),center.z+r*Math.cos(theta))},createDebri=function(limitRadius,center){var geom=new three_module.BoxGeometry(1,1,1),material=new three_module.MeshPhongMaterial;material.color=new three_module.Color(16777215*Math.random()),material.emissive=new three_module.Color(3355443),material.specular=new three_module.Color(4474026),material.shininess=100;var mesh=new three_module.Mesh(geom,material);return putDebriRandom(mesh,limitRadius,center),mesh.rotation.x=2*Math.random()*Math.PI,mesh.rotation.y=2*Math.random()*Math.PI,mesh.rotation.z=2*Math.random()*Math.PI,{mesh:mesh,drotx:(Math.random()-.5)/10,droty:(Math.random()-.5)/10,drotz:(Math.random()-.5)/10}},deselectDebri=function(){selectedDebri&&(selectedDebri.material.emissive.setHex(3355443),selectedDebri.scale.set(1,1,1)),selectedDebri=null},earth=(geom=new three_module.SphereGeometry(10,80,80),textureLoader=new three_module.TextureLoader,planetTexture=textureLoader.load("./assets/Earth.png"),specularTexture=textureLoader.load("./assets/EarthSpec.png"),normalTexture=textureLoader.load("./assets/EarthNormal.png"),(planetMaterial=new three_module.MeshPhongMaterial).specularMap=specularTexture,planetMaterial.specular=new three_module.Color(4474026),planetMaterial.shininess=5,planetMaterial.normalMap=normalTexture,planetMaterial.normalScale=new three_module.Vector2(5,5),planetMaterial.map=planetTexture,SceneUtils.a.createMultiMaterialObject(geom,[planetMaterial]));earth.position.y=-10,scene.add(earth);var air=function(geom){var planetMaterial=new three_module.MeshPhongMaterial;return planetMaterial.side=three_module.BackSide,planetMaterial.transparent=!0,planetMaterial.opacity=.2,planetMaterial.color=new three_module.Color(16777215),SceneUtils.a.createMultiMaterialObject(geom,[planetMaterial])}(new three_module.SphereGeometry(10.1,80,80));air.position.copy(earth.position),scene.add(air);var moon=function(geom){var textureLoader=new three_module.TextureLoader,planetTexture=textureLoader.load("./assets/Moon.png"),normalTexture=textureLoader.load("./assets/Mars-normalmap_2k.png"),planetMaterial=new three_module.MeshPhongMaterial;return planetMaterial.normalMap=normalTexture,planetMaterial.normalScale=new three_module.Vector2(5,5),planetMaterial.map=planetTexture,planetMaterial.specularMap=planetTexture,planetMaterial.specular=new three_module.Color(4473856),planetMaterial.shininess=0,new three_module.Mesh(geom,planetMaterial)}(new three_module.SphereGeometry(5,20,20));moon.position.x=-50,earth.add(moon);earth.position;var rad=Math.abs(moon.position.x);earth.add(createStarPoints(100,5,0,rad,!0)),earth.add(createStarPoints(500,3,0,rad)),earth.add(createStarPoints(2e3,2,0,rad));for(var earthAndDebris=[earth],debris=[],i=0;i<30;i++){var debri=createDebri(10.2,earth.position);earth.add(debri.mesh),debris.push(debri);var earthGroup=new three_module.Group;earthGroup.add(debri.mesh),earthAndDebris.push(earthGroup)}var ambi=new three_module.AmbientLight(1579032);scene.add(ambi);var directionalLight=new three_module.DirectionalLight(16777215);directionalLight.position.set(100,0,150),earth.add(directionalLight);var directionalBackLight=new three_module.DirectionalLight(16777215);directionalBackLight.position.copy(directionalLight.position.clone().negate()),directionalBackLight.intensity=.7,earth.add(directionalBackLight),document.getElementById("WebGL-output").appendChild(renderer.domElement),renderer.domElement.addEventListener("click",(function(){if(document.mozFullScreen||document.webkitIsFullScreen)limitRadius=10.2,center=earth.position,selectedDebri&&(putDebriRandom(selectedDebri,limitRadius,center),deselectDebri());else{var canvas=renderer.domElement;(canvas.mozRequestFullScreen||canvas.webkitRequestFullScreen).bind(canvas)()}var limitRadius,center})),window.addEventListener("resize",(function(){camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),effect.setSize(VIEWPORT_W,VIEWPORT_H)}),!1);var renderScene=function(){debris.forEach((function(_a){var mesh=_a.mesh,drotx=_a.drotx,droty=_a.droty,drotz=_a.drotz;mesh.rotation.x+=drotx,mesh.rotation.y+=droty,mesh.rotation.z+=drotz})),function(){raycaster.setFromCamera({x:0,y:0},camera);var intersects=raycaster.intersectObjects(earthAndDebris);if(0===intersects.length)deselectDebri();else for(var i=0;i<intersects.length;i++){var debri=intersects[i].object;if(debri===earth){console.log(debri===earth);break}if(selectedDebri!==debri){deselectDebri(),selectedDebri=debri,debri.material.emissive.setHex(16724787),debri.scale.set(2,2,2);break}}}(),controls.update(),earth.rotation.z-=.001,requestAnimationFrame(renderScene),renderer.render(scene,camera)};renderScene()}},721:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return SceneUtils}));var _build_three_module_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(718),SceneUtils={createMultiMaterialObject:function(geometry,materials){for(var group=new _build_three_module_js__WEBPACK_IMPORTED_MODULE_0__.Group,i=0,l=materials.length;i<l;i++)group.add(new _build_three_module_js__WEBPACK_IMPORTED_MODULE_0__.Mesh(geometry,materials[i]));return group},detach:function(child,parent,scene){console.warn("THREE.SceneUtils: detach() has been deprecated. Use scene.attach( child ) instead."),scene.attach(child)},attach:function(child,scene,parent){console.warn("THREE.SceneUtils: attach() has been deprecated. Use parent.attach( child ) instead."),parent.attach(child)}}}}]);
//# sourceMappingURL=111.f359add554ab79230197.bundle.js.map