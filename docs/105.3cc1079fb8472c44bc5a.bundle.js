(window.webpackJsonp=window.webpackJsonp||[]).push([[105],{346:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var three_module=__webpack_require__(691),stats_min=__webpack_require__(690),chroma=__webpack_require__(706),OBJLoader=__webpack_require__(697),MTLLoader=__webpack_require__(701),TrackballControls=function(object,domElement){var _this=this,STATE={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=object,this.domElement=void 0!==domElement?domElement:document,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=[65,83,68],this.mouseButtons={LEFT:three_module.MOUSE.ROTATE,MIDDLE:three_module.MOUSE.ZOOM,RIGHT:three_module.MOUSE.PAN},this.target=new three_module.Vector3;var lastPosition=new three_module.Vector3,_state=STATE.NONE,_keyState=STATE.NONE,_eye=new three_module.Vector3,_movePrev=new three_module.Vector2,_moveCurr=new three_module.Vector2,_lastAxis=new three_module.Vector3,_lastAngle=0,_zoomStart=new three_module.Vector2,_zoomEnd=new three_module.Vector2,_touchZoomDistanceStart=0,_touchZoomDistanceEnd=0,_panStart=new three_module.Vector2,_panEnd=new three_module.Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone();var changeEvent={type:"change"},startEvent={type:"start"},endEvent={type:"end"};this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{var box=this.domElement.getBoundingClientRect(),d=this.domElement.ownerDocument.documentElement;this.screen.left=box.left+window.pageXOffset-d.clientLeft,this.screen.top=box.top+window.pageYOffset-d.clientTop,this.screen.width=box.width,this.screen.height=box.height}};var vector,angle,axis,quaternion,eyeDirection,objectUpDirection,objectSidewaysDirection,moveDirection,mouseChange,objectUp,pan,getMouseOnScreen=(vector=new three_module.Vector2,function getMouseOnScreen(pageX,pageY){return vector.set((pageX-_this.screen.left)/_this.screen.width,(pageY-_this.screen.top)/_this.screen.height),vector}),getMouseOnCircle=function(){var vector=new three_module.Vector2;return function getMouseOnCircle(pageX,pageY){return vector.set((pageX-.5*_this.screen.width-_this.screen.left)/(.5*_this.screen.width),(_this.screen.height+2*(_this.screen.top-pageY))/_this.screen.width),vector}}();function keydown(event){!1!==_this.enabled&&(window.removeEventListener("keydown",keydown),_keyState===STATE.NONE&&(event.keyCode!==_this.keys[STATE.ROTATE]||_this.noRotate?event.keyCode!==_this.keys[STATE.ZOOM]||_this.noZoom?event.keyCode!==_this.keys[STATE.PAN]||_this.noPan||(_keyState=STATE.PAN):_keyState=STATE.ZOOM:_keyState=STATE.ROTATE))}function keyup(){!1!==_this.enabled&&(_keyState=STATE.NONE,window.addEventListener("keydown",keydown,!1))}function mousedown(event){if(!1!==_this.enabled){if(event.preventDefault(),event.stopPropagation(),_state===STATE.NONE)switch(event.button){case _this.mouseButtons.LEFT:_state=STATE.ROTATE;break;case _this.mouseButtons.MIDDLE:_state=STATE.ZOOM;break;case _this.mouseButtons.RIGHT:_state=STATE.PAN;break;default:_state=STATE.NONE}var state=_keyState!==STATE.NONE?_keyState:_state;state!==STATE.ROTATE||_this.noRotate?state!==STATE.ZOOM||_this.noZoom?state!==STATE.PAN||_this.noPan||(_panStart.copy(getMouseOnScreen(event.pageX,event.pageY)),_panEnd.copy(_panStart)):(_zoomStart.copy(getMouseOnScreen(event.pageX,event.pageY)),_zoomEnd.copy(_zoomStart)):(_moveCurr.copy(getMouseOnCircle(event.pageX,event.pageY)),_movePrev.copy(_moveCurr)),document.addEventListener("mousemove",mousemove,!1),document.addEventListener("mouseup",mouseup,!1),_this.dispatchEvent(startEvent)}}function mousemove(event){if(!1!==_this.enabled){event.preventDefault(),event.stopPropagation();var state=_keyState!==STATE.NONE?_keyState:_state;state!==STATE.ROTATE||_this.noRotate?state!==STATE.ZOOM||_this.noZoom?state!==STATE.PAN||_this.noPan||_panEnd.copy(getMouseOnScreen(event.pageX,event.pageY)):_zoomEnd.copy(getMouseOnScreen(event.pageX,event.pageY)):(_movePrev.copy(_moveCurr),_moveCurr.copy(getMouseOnCircle(event.pageX,event.pageY)))}}function mouseup(event){!1!==_this.enabled&&(event.preventDefault(),event.stopPropagation(),_state=STATE.NONE,document.removeEventListener("mousemove",mousemove),document.removeEventListener("mouseup",mouseup),_this.dispatchEvent(endEvent))}function mousewheel(event){if(!1!==_this.enabled&&!0!==_this.noZoom){switch(event.preventDefault(),event.stopPropagation(),event.deltaMode){case 2:_zoomStart.y-=.025*event.deltaY;break;case 1:_zoomStart.y-=.01*event.deltaY;break;default:_zoomStart.y-=25e-5*event.deltaY}_this.dispatchEvent(startEvent),_this.dispatchEvent(endEvent)}}function touchstart(event){if(!1!==_this.enabled){switch(event.preventDefault(),event.touches.length){case 1:_state=STATE.TOUCH_ROTATE,_moveCurr.copy(getMouseOnCircle(event.touches[0].pageX,event.touches[0].pageY)),_movePrev.copy(_moveCurr);break;default:_state=STATE.TOUCH_ZOOM_PAN;var dx=event.touches[0].pageX-event.touches[1].pageX,dy=event.touches[0].pageY-event.touches[1].pageY;_touchZoomDistanceEnd=_touchZoomDistanceStart=Math.sqrt(dx*dx+dy*dy);var x=(event.touches[0].pageX+event.touches[1].pageX)/2,y=(event.touches[0].pageY+event.touches[1].pageY)/2;_panStart.copy(getMouseOnScreen(x,y)),_panEnd.copy(_panStart)}_this.dispatchEvent(startEvent)}}function touchmove(event){if(!1!==_this.enabled)switch(event.preventDefault(),event.stopPropagation(),event.touches.length){case 1:_movePrev.copy(_moveCurr),_moveCurr.copy(getMouseOnCircle(event.touches[0].pageX,event.touches[0].pageY));break;default:var dx=event.touches[0].pageX-event.touches[1].pageX,dy=event.touches[0].pageY-event.touches[1].pageY;_touchZoomDistanceEnd=Math.sqrt(dx*dx+dy*dy);var x=(event.touches[0].pageX+event.touches[1].pageX)/2,y=(event.touches[0].pageY+event.touches[1].pageY)/2;_panEnd.copy(getMouseOnScreen(x,y))}}function touchend(event){if(!1!==_this.enabled){switch(event.touches.length){case 0:_state=STATE.NONE;break;case 1:_state=STATE.TOUCH_ROTATE,_moveCurr.copy(getMouseOnCircle(event.touches[0].pageX,event.touches[0].pageY)),_movePrev.copy(_moveCurr)}_this.dispatchEvent(endEvent)}}function contextmenu(event){!1!==_this.enabled&&event.preventDefault()}this.rotateCamera=(axis=new three_module.Vector3,quaternion=new three_module.Quaternion,eyeDirection=new three_module.Vector3,objectUpDirection=new three_module.Vector3,objectSidewaysDirection=new three_module.Vector3,moveDirection=new three_module.Vector3,function rotateCamera(){moveDirection.set(_moveCurr.x-_movePrev.x,_moveCurr.y-_movePrev.y,0),(angle=moveDirection.length())?(_eye.copy(_this.object.position).sub(_this.target),eyeDirection.copy(_eye).normalize(),objectUpDirection.copy(_this.object.up).normalize(),objectSidewaysDirection.crossVectors(objectUpDirection,eyeDirection).normalize(),objectUpDirection.setLength(_moveCurr.y-_movePrev.y),objectSidewaysDirection.setLength(_moveCurr.x-_movePrev.x),moveDirection.copy(objectUpDirection.add(objectSidewaysDirection)),axis.crossVectors(moveDirection,_eye).normalize(),angle*=_this.rotateSpeed,quaternion.setFromAxisAngle(axis,angle),_eye.applyQuaternion(quaternion),_this.object.up.applyQuaternion(quaternion),_lastAxis.copy(axis),_lastAngle=angle):!_this.staticMoving&&_lastAngle&&(_lastAngle*=Math.sqrt(1-_this.dynamicDampingFactor),_eye.copy(_this.object.position).sub(_this.target),quaternion.setFromAxisAngle(_lastAxis,_lastAngle),_eye.applyQuaternion(quaternion),_this.object.up.applyQuaternion(quaternion)),_movePrev.copy(_moveCurr)}),this.zoomCamera=function(){var factor;_state===STATE.TOUCH_ZOOM_PAN?(factor=_touchZoomDistanceStart/_touchZoomDistanceEnd,_touchZoomDistanceStart=_touchZoomDistanceEnd,_eye.multiplyScalar(factor)):(1!==(factor=1+(_zoomEnd.y-_zoomStart.y)*_this.zoomSpeed)&&factor>0&&_eye.multiplyScalar(factor),_this.staticMoving?_zoomStart.copy(_zoomEnd):_zoomStart.y+=(_zoomEnd.y-_zoomStart.y)*this.dynamicDampingFactor)},this.panCamera=(mouseChange=new three_module.Vector2,objectUp=new three_module.Vector3,pan=new three_module.Vector3,function panCamera(){mouseChange.copy(_panEnd).sub(_panStart),mouseChange.lengthSq()&&(mouseChange.multiplyScalar(_eye.length()*_this.panSpeed),pan.copy(_eye).cross(_this.object.up).setLength(mouseChange.x),pan.add(objectUp.copy(_this.object.up).setLength(mouseChange.y)),_this.object.position.add(pan),_this.target.add(pan),_this.staticMoving?_panStart.copy(_panEnd):_panStart.add(mouseChange.subVectors(_panEnd,_panStart).multiplyScalar(_this.dynamicDampingFactor)))}),this.checkDistances=function(){_this.noZoom&&_this.noPan||(_eye.lengthSq()>_this.maxDistance*_this.maxDistance&&(_this.object.position.addVectors(_this.target,_eye.setLength(_this.maxDistance)),_zoomStart.copy(_zoomEnd)),_eye.lengthSq()<_this.minDistance*_this.minDistance&&(_this.object.position.addVectors(_this.target,_eye.setLength(_this.minDistance)),_zoomStart.copy(_zoomEnd)))},this.update=function(){_eye.subVectors(_this.object.position,_this.target),_this.noRotate||_this.rotateCamera(),_this.noZoom||_this.zoomCamera(),_this.noPan||_this.panCamera(),_this.object.position.addVectors(_this.target,_eye),_this.checkDistances(),_this.object.lookAt(_this.target),lastPosition.distanceToSquared(_this.object.position)>1e-6&&(_this.dispatchEvent(changeEvent),lastPosition.copy(_this.object.position))},this.reset=function(){_state=STATE.NONE,_keyState=STATE.NONE,_this.target.copy(_this.target0),_this.object.position.copy(_this.position0),_this.object.up.copy(_this.up0),_eye.subVectors(_this.object.position,_this.target),_this.object.lookAt(_this.target),_this.dispatchEvent(changeEvent),lastPosition.copy(_this.object.position)},this.dispose=function(){this.domElement.removeEventListener("contextmenu",contextmenu,!1),this.domElement.removeEventListener("mousedown",mousedown,!1),this.domElement.removeEventListener("wheel",mousewheel,!1),this.domElement.removeEventListener("touchstart",touchstart,!1),this.domElement.removeEventListener("touchend",touchend,!1),this.domElement.removeEventListener("touchmove",touchmove,!1),document.removeEventListener("mousemove",mousemove,!1),document.removeEventListener("mouseup",mouseup,!1),window.removeEventListener("keydown",keydown,!1),window.removeEventListener("keyup",keyup,!1)},this.domElement.addEventListener("contextmenu",contextmenu,!1),this.domElement.addEventListener("mousedown",mousedown,!1),this.domElement.addEventListener("wheel",mousewheel,!1),this.domElement.addEventListener("touchstart",touchstart,!1),this.domElement.addEventListener("touchend",touchend,!1),this.domElement.addEventListener("touchmove",touchmove,!1),window.addEventListener("keydown",keydown,!1),window.addEventListener("keyup",keyup,!1),this.handleResize(),this.update()};(TrackballControls.prototype=Object.create(three_module.EventDispatcher.prototype)).constructor=TrackballControls;__webpack_exports__.default=function(){var VIEWPORT_W=window.innerWidth,VIEWPORT_H=window.innerHeight,scene=new three_module.Scene,camera=new three_module.PerspectiveCamera(45,VIEWPORT_W/VIEWPORT_H,.1,1e3);camera.position.x=100,camera.position.y=100,camera.position.z=300,camera.lookAt(new three_module.Vector3(0,0,0));var renderer=new three_module.WebGLRenderer;renderer.setClearColor(new three_module.Color(0)),renderer.setSize(VIEWPORT_W,VIEWPORT_H),renderer.shadowMap.enabled=!0;var trackballControls=new TrackballControls(camera);trackballControls.rotateSpeed=1,trackballControls.zoomSpeed=1,trackballControls.panSpeed=1,trackballControls.staticMoving=!0;var ambientLight=new three_module.AmbientLight(3684408);scene.add(ambientLight);var spotLight=new three_module.SpotLight(16777215);spotLight.position.set(300,300,300),spotLight.intensity=1,scene.add(spotLight),document.getElementById("WebGL-output").appendChild(renderer.domElement);var mesh,setRandomColors=function(object,scale){var children=object.children;children&&children.length>0?children.forEach((function(e){setRandomColors(e,scale)})):object instanceof three_module.Mesh&&_setRandomColors(object.material,scale)},_setRandomColors=function(material,scale){material instanceof three_module.MultiMaterial?material.materials.forEach((function(mat){_setRandomColors(mat,scale)})):(material.color=new three_module.Color(scale(Math.random()).hex()),material.name&&0==material.name.indexOf("building")&&(material.emissive=new three_module.Color(4473924),material.transparent=!0,material.opacity=.8))},load=function(object){var scale=chroma.scale(["red","green","blue"]);setRandomColors(object,scale),mesh=object,scene.add(mesh)};(new MTLLoader.a).load("./assets/city.mtl",(function(materials){materials.preload();var objLoader=new OBJLoader.a;objLoader.setMaterials(materials),objLoader.load("./assets/city.obj",load)}));var statsObj,stats=((statsObj=new stats_min).showPanel(0),statsObj.dom.style.position="absolute",statsObj.dom.style.left="0px",statsObj.dom.style.top="0px",document.getElementById("Stats-output").appendChild(statsObj.dom),statsObj);window.addEventListener("resize",(function(){camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight)}),!1);var renderScene=function(){stats.update(),trackballControls.update(),requestAnimationFrame(renderScene),renderer.render(scene,camera)};renderScene()}}}]);
//# sourceMappingURL=105.3cc1079fb8472c44bc5a.bundle.js.map