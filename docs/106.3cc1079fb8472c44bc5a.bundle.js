(window.webpackJsonp=window.webpackJsonp||[]).push([[106],{350:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var three_module=__webpack_require__(691),stats_min=__webpack_require__(690),chroma=__webpack_require__(706),OBJLoader=__webpack_require__(697),MTLLoader=__webpack_require__(701),FlyControls=function(object,domElement){function bind(scope,fn){return function(){fn.apply(scope,arguments)}}function contextmenu(event){event.preventDefault()}this.object=object,this.domElement=void 0!==domElement?domElement:document,domElement&&this.domElement.setAttribute("tabindex",-1),this.movementSpeed=1,this.rollSpeed=.005,this.dragToLook=!1,this.autoForward=!1,this.tmpQuaternion=new three_module.Quaternion,this.mouseStatus=0,this.moveState={up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0},this.moveVector=new three_module.Vector3(0,0,0),this.rotationVector=new three_module.Vector3(0,0,0),this.keydown=function(event){if(!event.altKey){switch(event.keyCode){case 16:this.movementSpeedMultiplier=.1;break;case 87:this.moveState.forward=1;break;case 83:this.moveState.back=1;break;case 65:this.moveState.left=1;break;case 68:this.moveState.right=1;break;case 82:this.moveState.up=1;break;case 70:this.moveState.down=1;break;case 38:this.moveState.pitchUp=1;break;case 40:this.moveState.pitchDown=1;break;case 37:this.moveState.yawLeft=1;break;case 39:this.moveState.yawRight=1;break;case 81:this.moveState.rollLeft=1;break;case 69:this.moveState.rollRight=1}this.updateMovementVector(),this.updateRotationVector()}},this.keyup=function(event){switch(event.keyCode){case 16:this.movementSpeedMultiplier=1;break;case 87:this.moveState.forward=0;break;case 83:this.moveState.back=0;break;case 65:this.moveState.left=0;break;case 68:this.moveState.right=0;break;case 82:this.moveState.up=0;break;case 70:this.moveState.down=0;break;case 38:this.moveState.pitchUp=0;break;case 40:this.moveState.pitchDown=0;break;case 37:this.moveState.yawLeft=0;break;case 39:this.moveState.yawRight=0;break;case 81:this.moveState.rollLeft=0;break;case 69:this.moveState.rollRight=0}this.updateMovementVector(),this.updateRotationVector()},this.mousedown=function(event){if(this.domElement!==document&&this.domElement.focus(),event.preventDefault(),event.stopPropagation(),this.dragToLook)this.mouseStatus++;else{switch(event.button){case 0:this.moveState.forward=1;break;case 2:this.moveState.back=1}this.updateMovementVector()}},this.mousemove=function(event){if(!this.dragToLook||this.mouseStatus>0){var container=this.getContainerDimensions(),halfWidth=container.size[0]/2,halfHeight=container.size[1]/2;this.moveState.yawLeft=-(event.pageX-container.offset[0]-halfWidth)/halfWidth,this.moveState.pitchDown=(event.pageY-container.offset[1]-halfHeight)/halfHeight,this.updateRotationVector()}},this.mouseup=function(event){if(event.preventDefault(),event.stopPropagation(),this.dragToLook)this.mouseStatus--,this.moveState.yawLeft=this.moveState.pitchDown=0;else{switch(event.button){case 0:this.moveState.forward=0;break;case 2:this.moveState.back=0}this.updateMovementVector()}this.updateRotationVector()},this.update=function(delta){var moveMult=delta*this.movementSpeed,rotMult=delta*this.rollSpeed;this.object.translateX(this.moveVector.x*moveMult),this.object.translateY(this.moveVector.y*moveMult),this.object.translateZ(this.moveVector.z*moveMult),this.tmpQuaternion.set(this.rotationVector.x*rotMult,this.rotationVector.y*rotMult,this.rotationVector.z*rotMult,1).normalize(),this.object.quaternion.multiply(this.tmpQuaternion),this.object.rotation.setFromQuaternion(this.object.quaternion,this.object.rotation.order)},this.updateMovementVector=function(){var forward=this.moveState.forward||this.autoForward&&!this.moveState.back?1:0;this.moveVector.x=-this.moveState.left+this.moveState.right,this.moveVector.y=-this.moveState.down+this.moveState.up,this.moveVector.z=-forward+this.moveState.back},this.updateRotationVector=function(){this.rotationVector.x=-this.moveState.pitchDown+this.moveState.pitchUp,this.rotationVector.y=-this.moveState.yawRight+this.moveState.yawLeft,this.rotationVector.z=-this.moveState.rollRight+this.moveState.rollLeft},this.getContainerDimensions=function(){return this.domElement!=document?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[window.innerWidth,window.innerHeight],offset:[0,0]}},this.dispose=function(){this.domElement.removeEventListener("contextmenu",contextmenu,!1),this.domElement.removeEventListener("mousedown",_mousedown,!1),this.domElement.removeEventListener("mousemove",_mousemove,!1),this.domElement.removeEventListener("mouseup",_mouseup,!1),window.removeEventListener("keydown",_keydown,!1),window.removeEventListener("keyup",_keyup,!1)};var _mousemove=bind(this,this.mousemove),_mousedown=bind(this,this.mousedown),_mouseup=bind(this,this.mouseup),_keydown=bind(this,this.keydown),_keyup=bind(this,this.keyup);this.domElement.addEventListener("contextmenu",contextmenu,!1),this.domElement.addEventListener("mousemove",_mousemove,!1),this.domElement.addEventListener("mousedown",_mousedown,!1),this.domElement.addEventListener("mouseup",_mouseup,!1),window.addEventListener("keydown",_keydown,!1),window.addEventListener("keyup",_keyup,!1),this.updateMovementVector(),this.updateRotationVector()};__webpack_exports__.default=function(){var VIEWPORT_W=window.innerWidth,VIEWPORT_H=window.innerHeight,clock=new three_module.Clock,scene=new three_module.Scene,camera=new three_module.PerspectiveCamera(45,VIEWPORT_W/VIEWPORT_H,.1,1e3);camera.position.x=100,camera.position.y=100,camera.position.z=300,camera.lookAt(new three_module.Vector3(0,0,0));var renderer=new three_module.WebGLRenderer;renderer.setClearColor(new three_module.Color(0)),renderer.setSize(VIEWPORT_W,VIEWPORT_H),renderer.shadowMap.enabled=!0;var flyControls=new FlyControls(camera);flyControls.movementSpeed=25,flyControls.domElement=document.querySelector("#WebGL-output"),flyControls.rollSpeed=Math.PI/24,flyControls.autoForward=!0,flyControls.dragToLook=!1;var ambientLight=new three_module.AmbientLight(3684408);scene.add(ambientLight);var spotLight=new three_module.SpotLight(16777215);spotLight.position.set(100,140,130),spotLight.intensity=2,scene.add(spotLight),document.getElementById("WebGL-output").appendChild(renderer.domElement);var mesh,setRandomColors=function(object,scale){var children=object.children;children&&children.length>0?children.forEach((function(e){setRandomColors(e,scale)})):object instanceof three_module.Mesh&&_setRandomColors(object.material,scale)},_setRandomColors=function(material,scale){material instanceof three_module.MultiMaterial?material.materials.forEach((function(mat){_setRandomColors(mat,scale)})):(material.color=new three_module.Color(scale(Math.random()).hex()),material.name&&0==material.name.indexOf("building")&&(material.emissive=new three_module.Color(4473924),material.transparent=!0,material.opacity=.8))},load=function(object){var scale=chroma.scale(["red","green","blue"]);setRandomColors(object,scale),mesh=object,scene.add(mesh)};(new three_module.TextureLoader).load("./assets/tex/metro01.jpg"),(new MTLLoader.a).load("./assets/city.mtl",(function(materials){materials.preload();var objLoader=new OBJLoader.a;objLoader.setMaterials(materials),objLoader.load("./assets/city.obj",load)}));var statsObj,stats=((statsObj=new stats_min).showPanel(0),statsObj.dom.style.position="absolute",statsObj.dom.style.left="0px",statsObj.dom.style.top="0px",document.getElementById("Stats-output").appendChild(statsObj.dom),statsObj);window.addEventListener("resize",(function(){camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight)}),!1);var renderScene=function(){stats.update();var delta=clock.getDelta();flyControls.update(delta),renderer.clear(),requestAnimationFrame(renderScene),renderer.render(scene,camera)};renderScene()}}}]);
//# sourceMappingURL=106.3cc1079fb8472c44bc5a.bundle.js.map