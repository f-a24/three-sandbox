{"version":3,"file":"12.c8f2cf5d170200fd0583.bundle.js","sources":["webpack:///./src/chapter7/4.ts"],"sourcesContent":["import * as THREE from 'three';\r\nimport * as Stats from 'stats.js';\r\n\r\nexport default () => {\r\n  // 画面サイズ\r\n  const VIEWPORT_W = window.innerWidth;\r\n  const VIEWPORT_H = window.innerHeight;\r\n\r\n  /* scene */\r\n  const scene = new THREE.Scene();\r\n\r\n  /* camera */\r\n  const camera = new THREE.PerspectiveCamera(\r\n    45,\r\n    VIEWPORT_W / VIEWPORT_H,\r\n    0.1,\r\n    1000\r\n  );\r\n  camera.position.x = 20;\r\n  camera.position.y = 0;\r\n  camera.position.z = 150;\r\n\r\n  /* renderer */\r\n  const renderer = new THREE.WebGLRenderer();\r\n  renderer.setClearColor(new THREE.Color(0x000000));\r\n  renderer.setSize(VIEWPORT_W, VIEWPORT_H);\r\n\r\n  /* context2d */\r\n  const getTexture = () => {\r\n    const canvasEl = document.createElement('canvas');\r\n    canvasEl.width = 32;\r\n    canvasEl.height = 32;\r\n    const ctx = canvasEl.getContext('2d');\r\n\r\n    // the body\r\n    ctx.translate(-81, -84);\r\n    ctx.fillStyle = 'orange';\r\n    ctx.beginPath();\r\n    ctx.moveTo(83, 116);\r\n    ctx.lineTo(83, 102);\r\n    ctx.bezierCurveTo(83, 94, 89, 88, 97, 88);\r\n    ctx.bezierCurveTo(105, 88, 111, 94, 111, 102);\r\n    ctx.lineTo(111, 116);\r\n    ctx.lineTo(106.333, 111.333);\r\n    ctx.lineTo(101.666, 116);\r\n    ctx.lineTo(97, 111.333);\r\n    ctx.lineTo(92.333, 116);\r\n    ctx.lineTo(87.666, 111.333);\r\n    ctx.lineTo(83, 116);\r\n    ctx.fill();\r\n\r\n    // the eyes\r\n    ctx.fillStyle = 'white';\r\n    ctx.beginPath();\r\n    ctx.moveTo(91, 96);\r\n    ctx.bezierCurveTo(88, 96, 87, 99, 87, 101);\r\n    ctx.bezierCurveTo(87, 103, 88, 106, 91, 106);\r\n    ctx.bezierCurveTo(94, 106, 95, 103, 95, 101);\r\n    ctx.bezierCurveTo(95, 99, 94, 96, 91, 96);\r\n    ctx.moveTo(103, 96);\r\n    ctx.bezierCurveTo(100, 96, 99, 99, 99, 101);\r\n    ctx.bezierCurveTo(99, 103, 100, 106, 103, 106);\r\n    ctx.bezierCurveTo(106, 106, 107, 103, 107, 101);\r\n    ctx.bezierCurveTo(107, 99, 106, 96, 103, 96);\r\n    ctx.fill();\r\n\r\n    // the pupils\r\n    ctx.fillStyle = 'blue';\r\n    ctx.beginPath();\r\n    ctx.arc(101, 102, 2, 0, Math.PI * 2, true);\r\n    ctx.fill();\r\n    ctx.beginPath();\r\n    ctx.arc(89, 102, 2, 0, Math.PI * 2, true);\r\n    ctx.fill();\r\n\r\n    const texture = new THREE.CanvasTexture(canvasEl);\r\n    texture.needsUpdate = true;\r\n    return texture;\r\n  };\r\n\r\n  const createSprites = () => {\r\n    const material = new THREE.SpriteMaterial({\r\n      map: getTexture(),\r\n      color: 0xffffff\r\n    });\r\n\r\n    const range = 500;\r\n    for (let i = 0; i < 1500; i++) {\r\n      const sprite = new THREE.Sprite(material);\r\n      sprite.position.set(\r\n        Math.random() * range - range / 2,\r\n        Math.random() * range - range / 2,\r\n        Math.random() * range - range / 2\r\n      );\r\n      sprite.scale.set(4, 4, 4);\r\n      scene.add(sprite);\r\n    }\r\n  };\r\n\r\n  document.getElementById('WebGL-output').appendChild(renderer.domElement);\r\n\r\n  /* stats */\r\n  const initStats = () => {\r\n    const statsObj = new Stats();\r\n    statsObj.showPanel(0);\r\n    statsObj.dom.style.position = 'absolute';\r\n    statsObj.dom.style.left = '0px';\r\n    statsObj.dom.style.top = '0px';\r\n    document.getElementById('Stats-output').appendChild(statsObj.dom);\r\n    return statsObj;\r\n  };\r\n  const stats = initStats();\r\n\r\n  /* render */\r\n  const renderScene = () => {\r\n    stats.update();\r\n\r\n    requestAnimationFrame(renderScene);\r\n    renderer.render(scene, camera);\r\n  };\r\n  createSprites();\r\n  renderScene();\r\n};\r\n"],"mappings":"AAAA","sourceRoot":""}